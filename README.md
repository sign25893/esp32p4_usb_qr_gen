
# üì¶ ESP32-P4 USB QR Code Generator

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **ESP32-P4** –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –≤–Ω–µ—à–Ω–µ–π USB-—Ñ–ª–µ—à–∫–æ–π –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ **QR-–∫–æ–¥–æ–≤** –≤ –≤–∏–¥–µ PNG-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä—è–º–æ –Ω–∞ –Ω–µ—ë.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìé –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ USB Mass Storage (MSC) —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (—Ñ–ª–µ—à–µ–∫).
- üßæ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/usb/qr` –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è **1 - 50 PNG —Ñ–∞–π–ª–æ–≤** —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ QR-–∫–æ–¥–∞–º–∏ (UUID v4).
- üñ®Ô∏è –û—Ç—Ä–∏—Å–æ–≤–∫–∞ QR-–∫–æ–¥–æ–≤ –≤ –≤–∏–¥–µ PNG —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `libpng`.
- üëÇ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞.

---

## üß∞ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **ESP32-P4**
- [ESP-IDF v5.4+](https://docs.espressif.com/projects/esp-idf/en/latest/esp32p4/get-started/index.html)
- USB OTG-–ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –ü–æ–¥–∫–ª—é—á–∞–µ–º–æ–µ USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (MSC)

---

## üõ†Ô∏è –°–±–æ—Ä–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

    ```bash
    git clone https://github.com/yourusername/esp32p4-usb-qr-generator.git
    cd esp32p4-usb-qr-generator
    ```

2. **–í—ã–±–µ—Ä–∏—Ç–µ —Ü–µ–ª–µ–≤—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É:**

    ```bash
    idf.py set-target esp32p4
    ```

3. **–°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:**

    ```bash
    idf.py build
    ```

4. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–æ—à–∏–≤–∫—É:**

    ```bash
    idf.py -p /dev/ttyUSB0 flash monitor
    ```

---

## ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ USB-—Ñ–ª–µ—à–∫—É –∫ –≤–∞—à–µ–º—É ESP32-P4.
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ, –ø–æ–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –±—É–¥–µ—Ç —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ.
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è QR-–∫–æ–¥—ã –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `/usb/qr/qr_N.png`.
4. –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ GPIO0 –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é —Ä–∞–±–æ—Ç—ã –∑–∞–¥–∞—á–∏ –∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Ñ–ª–µ—à–∫–∏.

---

## üß™ –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

–§—É–Ω–∫—Ü–∏—è, –æ—Ç–≤–µ—á–∞—é—â–∞—è –∑–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é QR PNG:

```c
void usb_generate_qr_to_flash(void) {
    if (usb_mount && !qr_generated) {
        ESP_LOGI(TAG, "Generating QR codes on USB flash");
        file_operations();
        qr_generated = true;
    } else if (!usb_mount) {
        ESP_LOGW(TAG, "USB device not present, skipping QR generation");
    } else if (qr_generated) {
        ESP_LOGI(TAG, "QR codes already generated on USB flash");
    }
}
```

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Ñ–ª–µ—à–∫–µ

–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–µ–π:

```
/usb/
‚îî‚îÄ‚îÄ qr/
    ‚îú‚îÄ‚îÄ qr_0.png
    ‚îú‚îÄ‚îÄ qr_1.png
    ‚îú‚îÄ‚îÄ ...
    ‚îî‚îÄ‚îÄ qr_49.png
```

---

## üì∏ –ü—Ä–∏–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

–ö–∞–∂–¥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç QR-–∫–æ–¥, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–∑ UUIDv4 –∏ –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω–Ω—ã–π –∫–∞–∫ PNG-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–º 116x116 –ø–∏–∫—Å–µ–ª–µ–π (–ø—Ä–∏ `png_scale = 4`).

---

## üìã –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `esp_qrcode` ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR-–∫–æ–¥–æ–≤
- `libpng` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PNG-—Ñ–∞–π–ª–æ–≤
- `msc_host` ‚Äî USB Mass Storage Host –¥—Ä–∞–π–≤–µ—Ä ESP-IDF

---

## üîê –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **MIT**. –°–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

---

## üí¨ –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

–û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ issue –∏–ª–∏ pull request, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –≤–Ω–µ—Å—Ç–∏ –≤–∫–ª–∞–¥ –∏–ª–∏ –Ω–∞—à–ª–∏ –±–∞–≥.
